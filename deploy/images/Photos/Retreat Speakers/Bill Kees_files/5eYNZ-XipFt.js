/*1347857583,173214271*/

if (window.CavalryLogger) { CavalryLogger.start_js(["zdgw\/"]); }

__d("legacy:XHPTemplate",["XHPTemplate"],function(a,b,c,d){a.XHPTemplate=b('XHPTemplate');},3);
function DynamicFacepile(){}copyProperties(DynamicFacepile.prototype,{init:function(a,b,c,d){this._facepile=c;this._maxFacepileSize=b;this._memberIDs=a;this._facepileItemMap={};var e=DOM.scry(this._facepile,'li');for(var f=0,g=a.length;f<g;++f)this._facepileItemMap[a[f]]=e[f];this._template=d;},containsID:function(a){return this._facepileItemMap[a];},removeFacepileItem:function(a){var b=this._facepileItemMap[a.uid];if(!b)return;delete this._facepileItemMap[a.uid];this._memberIDs.splice(this._memberIDs.indexOf(a.uid),1);DOM.remove(b);},addFacepileItem:function(a){var b=this._template.render(),c=XHPTemplate.getNode(b,'img');c.src=a.photo;var d=XHPTemplate.getNode(b,'anchor');d.href=URI('/profile.php').addQueryData({id:a.uid});TooltipLink.setTooltipText(d,a.name);DOM.prependContent(this._facepile,b);this._facepileItemMap[a.uid]=b;this._memberIDs.unshift(a.uid);if(this._memberIDs.length>this._maxFacepileSize){var e=this._memberIDs.pop(),f=this._facepileItemMap[e];DOM.remove(f);delete this._facepileItemMap[e];}}});
var FriendsDashSideCol={init:function(a){this._flid=a;var b='listeditor/friend_lists_changed',c=Arbiter.subscribe(b,function(d,e){if(d==b&&e.list_info.list_id==this._flid){if(e.refresh_member_box)new AsyncRequest('/ajax/friends/lists/list_modified.php').setMethod('GET').setReadOnly(true).setData({list_id:this._flid}).send();if(e.removed_uid){DOM.scry($('home_stream'),'.aid_'+e.removed_uid).forEach(CSS.hide);}else if(e.undo_remove&&e.added_uid){DOM.scry($('home_stream'),'.aid_'+e.added_uid).forEach(CSS.show);}else Arbiter.inform(UIIntentionalStreamMessage.REFRESH_STREAM,{filter:'fl_'+this._flid,noScroll:1});}}.bind(this),Arbiter.SUBSCRIBE_NEW);PageTransitions.registerHandler(Arbiter.unsubscribe.curry(c));}};
__d("CloseFriendsSuggestionMegaphone",["Animation","Arbiter","AsyncRequest","Composer","CSS","DOM","PageTransitions","$","createObjectFrom","cx","ge"],function(a,b,c,d,e,f){var g=b('Animation'),h=b('Arbiter'),i=b('AsyncRequest'),j=b('Composer'),k=b('CSS'),l=b('DOM'),m=b('PageTransitions'),n=b('$'),o=b('createObjectFrom'),p=b('cx'),q=b('ge'),r=400,s=235,t={},u=false,v,w,x,y,z,aa,ba={},ca,da=false,ea=0,fa=7,ga=8,ha=17,ia=25,ja=5;function ka(wa,xa,ya){new g(wa).show().from('opacity',0).to('opacity',1).duration(xa).ondone(ya).go();}function la(wa,xa,ya){new g(wa).from('opacity',1).to('opacity',0).hide().duration(xa).ondone(ya).go();}function ma(){var wa=l.scry(w,'li'),xa=u?ha:ga,ya=Math.min(xa,wa.length),za=[];for(var ab=0;ab<ya;ab++){var bb=wa[ab].id.split('_').pop();if(!ba[bb]){ba[bb]=true;za.push(bb);}}var cb={tids:za,key:ca};new i().setURI('/friends/ajax/log_data.php').setData(cb).send();}function na(){if(!u){u=true;new g(w).to('height',s).duration(r).go();ka(x,r);}}function oa(){for(var wa in t)l.scry(w,'#cf_suggestion_item_'+wa).forEach(function(xa){k.hide(xa);});}function pa(){var wa="_wj fbTimelineBoxCount fbTimelineBoxCountFriends";l.replace(l.find(z,'.fbTimelineBoxCountFriends'),l.create('span',{className:wa},'+'+(aa-fa+1)));}function qa(wa,xa,ya){var za=l.find(wa,'.collector_item'),ab=l.find(wa,'.picker_item'),bb=ya?za:ab,cb=ya?ab:za;la(wa,r,function(){l.prependContent(xa,wa);k.show(bb);k.hide(cb);ka(wa,r);});ra(ya);}function ra(wa){if(wa){if(aa==fa+1){k.show(n('cf_suggestion_collector_overflow_num'));}else if(aa>fa+1)pa();if(aa){k.addClass(y,"cfSuggestionCollectorNonempty");k.show(n('cf_suggestion_collector_placeholder'));}}else{if(aa==fa){k.hide(n('cf_suggestion_collector_overflow_num'));}else if(aa>fa)pa();if(!aa){k.removeClass(y,"cfSuggestionCollectorNonempty");k.hide(n('cf_suggestion_collector_placeholder'));}}}function sa(){var wa={flid:v,purpose:'warning',cf_count:aa};new i().setURI('/ajax/friends/lists/cf_megaphone/contextual_dialog').setData(wa).send();}function ta(wa){na();var xa=l.find(w,'ul'),ya=l.find(y,'ul'),za=l.scry(z,'#cf_suggestion_item_'+wa);if(t[wa]){aa--;ea--;qa(za[0],xa,false);t[wa]=false;}else{aa++;ea++;if(aa>=ia&&ea>=ja&&!da){da=true;sa();}t[wa]=true;if(za.length){qa(za[0],ya,true);ma();}else{new i().setURI('/ajax/friends/lists/cf_megaphone/picker_item').setData({id:wa}).setHandler(function(ab){var bb=l.prependContent(ya,ab.payload)[0];ka(bb,r);ra(true);t[wa]=true;}.bind(this)).send();return;}}}function ua(){la(l.find(z,'^#megaphone_story_747'),r);var wa='#navItem_fl_'+v,xa=l.find(q('sideNav'),wa);if(xa){k.removeClass(n('listsNav'),'belowThreshold');var ya={flid:v,purpose:'edu'};new i().setURI('/ajax/friends/lists/cf_megaphone/contextual_dialog').setData(ya).send();}}var va={init:function(wa,xa,ya,za,ab){if(l.scry(n(xa),'#pagelet_home_stream')){z=l.find(l.prependContent(n(xa),wa)[0],'#cf_megaphone_content_id');w=l.find(z,'#cf_suggestion_picker');y=l.find(z,'#cf_suggestion_collector');x=l.find(z,'.doneButton');v=za;aa=ya.length;t=o(ya);ca=ab;var bb=h.subscribe('listeditor/friend_lists_changed',function(cb,db){if(db.list_info.list_id==za)if(db.removed_uid&&t[db.removed_uid]){ta(db.removed_uid);}else if(db.added_uid&&!t[db.added_uid])ta(db.added_uid);},h.SUBSCRIBE_NEW);m.registerHandler(h.unsubscribe.curry(bb));ma();}},expandPicker:function(){na();},hide:function(){ua();},toggleFriend:function(wa){ta(wa);var xa={flid:v,id:wa,source:'closefriendsmegaphone'};if(t[wa]){xa.add=1;}else xa.remove=1;new i().setURI('/friends/ajax/lists.php').setData(xa).send();}};a.CloseFriendsSuggestionMegaphone=e.exports=va;});
function FriendListMembersBox(){}copyProperties(FriendListMembersBox.prototype,{init:function(a,b,c,d,e,f,g){this._root=a;this._flid=b;this._listSize=d;this._headerTitle=DOM.find(this._root,'.uiHeaderTitle');this._headerActions=DOM.find(this._root,'.uiHeaderActions a');this._facepile=new DynamicFacepile();this._facepile.init(c,e,f.firstChild,g);var h=[Arbiter.subscribe(['FriendListSuggestions/add','FriendListMemberTypeahead/add','FriendListHovercard/add'],this.handleAddEvent.bind(this)),Arbiter.subscribe('FriendListHovercard/remove',this.handleRemoveEvent.bind(this))];PageTransitions.registerHandler(function(){h.forEach(Arbiter.unsubscribe);});},handleAddEvent:function(a,b){if(b.flid!==this._flid||!b.uid)return;if(this._facepile.containsID(b.uid))return;if(!b.photo||!b.name){requireLazy(['ShortProfiles'],function(c){c.get(b.uid,function(d,e){if(e.exist){d.flid=this._flid;d.photo=e.thumbSrc;d.name=e.firstName;this._facepile.addFacepileItem(d);}}.bind(this,b));}.bind(this));}else this._facepile.addFacepileItem(b);CSS.removeClass(this._root,'empty');CSS.show(this._headerActions);this._listSize++;this.updateListSize();},handleRemoveEvent:function(a,b){if(b.flid!==this._flid||!b.uid)return;this._listSize--;this.updateListSize();this._facepile.removeFacepileItem(b);},updateListSize:function(){DOM.setContent(this._headerTitle,tx._("On This List ({num_members})",{num_members:this._listSize}));}});
__d("FriendListSuggestions",["event-extensions","Arbiter","AsyncRequest","AsyncSignal","Bootloader","CSS","DOM","DynamicFriendListEducation","PageTransitions","Parent","UserAgent","copyProperties","csx","ge"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('AsyncRequest'),i=b('AsyncSignal'),j=b('Bootloader'),k=b('CSS'),l=b('DOM'),m=b('DynamicFriendListEducation'),n=b('PageTransitions'),o=b('Parent'),p=b('UserAgent'),q=b('copyProperties'),r=b('csx'),s=b('ge');function t(){}q(t.prototype,{init:function(u,v,w,x,y){this._container=u;this._flid=v;this._shouldSave=w;this._context=x;this._source=y;var z=Event.listen(u,'click',function(ba){var ca=ba.getTarget();o.byClass(ca,'addLink')&&this._handleAdd(ca);o.byClass(ca,'declineButton')&&this._handleDecline(ca);}.bind(this));if(p.ie()<7)j.loadModules(['ExplicitHover'],function(ba){this._explicitHover=new ba(this._container,'friendListSuggestion');}.bind(this));var aa=g.subscribe('FriendListMemberTypeahead/add',function(ba,ca){var da=s('suggestion_'+ca.uid);da&&this._swap(da);}.bind(this));n.registerHandler(function(){z.remove();aa.unsubscribe();this._explicitHover&&this._explicitHover.uninstall();}.bind(this));},_handleDecline:function(u){var v=o.byTag(u,'li');this._swap(v);},_handleAdd:function(u){var v=o.byTag(u,'li'),w=this._getUIDFromItem(v),x=function(y){if(y&&y.nux_cancel)return;this._swap(v);if(this._shouldSave)this._save(w,y);var z=l.scry(v,"img._s0")[0],aa=l.find(v,'td.userSuggestionName');g.inform('FriendListSuggestions/add',{flid:this._flid,uid:w,name:l.getText(aa),photo:z.src});}.bind(this);m.showContextualDialog(this._flid,w,u,x);},_getUIDFromItem:function(u){return ''+u.id.split('_')[1];},_swap:function(u){l.remove(u);var v=l.scry(this._container,'li.hidden_elem')[0];if(!v)return;k.show(v);var w=this._getUIDFromItem(v),x=''+v.getAttribute('data-coeff-key'),y={tids:[w],key:x};new i('/friends/ajax/log_data.php',y).send();},_save:function(u,v){var w={flid:this._flid,id:u,add:1,source:this._source};w[this.context]=1;if(v)q(w,v);new h().setURI('/friends/ajax/lists.php').setData(w).send();}});e.exports=t;});
__d("legacy:FriendListSuggestions",["FriendListSuggestions"],function(a,b,c,d){a.FriendListSuggestions=b('FriendListSuggestions');},3);
function FriendListMemberBoxTypeahead(){}copyProperties(FriendListMemberBoxTypeahead.prototype,{init:function(a,b,c){Event.listen(a.getCore().getElement(),'keyup',function(event){CSS.conditionClass(event.getTarget(),'noPadding',Style.get(event.getTarget(),'direction')=='rtl');});a.subscribe('select',function(e,f){var g=function(i){Arbiter.inform('FriendListMemberTypeahead/add',{flid:b,uid:f.selected.uid,name:f.selected.text,photo:f.selected.photo});var j={add:1,search:1,source:c,flid:b,id:f.selected.uid};copyProperties(j,i);new AsyncRequest().setURI('/friends/ajax/lists.php').setData(j).send();};if(f.selected.subscribee||f.selected.type=='page')return g();DynamicFriendListEducation.showDialog(b,f.selected.uid,g);var h=a.getData().getExclusions();h.push(f.selected.uid);a.getData().setExclusions(h);});var d=Arbiter.subscribe('listeditor/friend_lists_changed',function(e,f){if(f.list_info.list_id==b){var g=a.getData().getExclusions();if(f.removed_uid){g.remove(f.removed_uid);}else if(f.added_uid)g.push(f.added_uid);a.getData().setExclusions(g);}},Arbiter.SUBSCRIBE_NEW);PageTransitions.registerHandler(Arbiter.unsubscribe.curry(d));}});
__d("CloseFriendsTypeaheadRenderer",["DOM","SearchTypeaheadRenderer"],function(a,b,c,d,e,f){var g=b('DOM'),h=b('SearchTypeaheadRenderer');function i(j,k){var l=h(j,k),m=g.create('div',{className:'star'});g.appendContent(l,m);return l;}i.className='closefriends';e.exports=i;});
__d("legacy:CloseFriendsTypeaheadRenderer",["CloseFriendsTypeaheadRenderer"],function(a,b,c,d){if(!a.TypeaheadRenderers)a.TypeaheadRenderers={};a.TypeaheadRenderers.closefriends=b('CloseFriendsTypeaheadRenderer');},3);
__d("legacy:DynamicFriendListEducation",["DynamicFriendListEducation"],function(a,b,c,d){a.DynamicFriendListEducation=b('DynamicFriendListEducation');},3);
__d("FriendListMenu",["event-extensions","Arbiter","AsyncRequest","CSS","DOM","HTML","Input","Keys","Menu","Parent"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('AsyncRequest'),i=b('CSS'),j=b('DOM'),k=b('HTML'),l=b('Input'),m=b('Keys'),n=b('Menu'),o=b('Parent'),p={init:function(q){n.register(q,false);var r=j.find(q,'.FriendListCreateTrigger'),s=j.find(q,'.CreateListInputItem'),t=j.find(s,'.createListInput');n.subscribe('select',function(u,v){if(v.item==r){i.addClass(q,'FriendListMenuCreate');l.focus(t);}});Event.listen(t,'blur',function(u){if(l.isEmpty(t))i.removeClass(q,'FriendListMenuCreate');});Event.listen(t,'keydown',function(u){if(Event.getKeyCode(u)==m.RETURN&&/[^\s]/.test(t.value))new h().setURI('/ajax/friends/lists/create.php').setData({name:t.value,id:q.id}).setHandler(function(){l.reset(t);i.removeClass(q,'FriendListMenuCreate');}).send();});g.subscribe('friend-list/new',function(u,v){var w=k(v.new_li).getRootNode();j.insertBefore(r,w);if(v.id===q.id){n.focusItem(w);n.inform('select',{menu:o.byClass(w,'uiMenu'),item:w});}else n.toggleItem(w);});},addToAnotherList:function(q,r){Event.listen(q,'click',function(event){var s=o.byClass(q,'FlyoutFriendMenu');i.removeClass(s,'addToListsClosed');i.addClass(s,'addToListsOpen');});},goBack:function(q,r){Event.listen(q,'click',function(event){var s=o.byClass(q,'FlyoutFriendMenu');i.removeClass(s,'addToListsOpen');i.addClass(s,'addToListsClosed');});}};e.exports=p;});
__d("RestrictedFriendListEducation",["Arbiter","AsyncRequest"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncRequest'),i,j;function k(m,n){if(n.flid==i)if(m=='FriendListHovercard/add'){if(j)return;j=true;new h().setURI('/ajax/friends/lists/restricted_edu.php').setData({target:n.uid,flid:n.flid}).send();}else if(m=='RestrictedListNUX/okay')new h().setURI('/ajax/friends/lists/nux_log.php').setData(n).send();return true;}var l={init:function(m){i=m;g.subscribe(['FriendListHovercard/add','RestrictedListNUX/okay'],k);}};e.exports=l;});
__d("legacy:FriendListRestrictedEducation",["RestrictedFriendListEducation"],function(a,b,c,d){a.RestrictedFriendListEducation=b('RestrictedFriendListEducation');},3);
__d("legacy:ShortProfiles",["ShortProfiles"],function(a,b,c,d){a.ShortProfiles=b('ShortProfiles');},3);