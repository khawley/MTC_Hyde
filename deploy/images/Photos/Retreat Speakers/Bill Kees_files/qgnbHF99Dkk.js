/*1349661942,173220389*/

if (window.CavalryLogger) { CavalryLogger.start_js(["7L4Qj"]); }

__d("OnlyMeUI",["AudienceSelector","Arbiter","CSS","DOM","Parent","PrivacyConst","Selector","$","tx"],function(a,b,c,d,e,f){var g=b('AudienceSelector'),h=b('Arbiter'),i=b('CSS'),j=b('DOM'),k=b('Parent'),l=b('PrivacyConst'),m=b('Selector'),n=b('$'),o=b('tx');function p(){return [j.create('div',{className:'onlyMeBorder'}),j.create('div',{className:'onlyMeBorder onlyMeBorderBottom'})];}function q(){return j.create('img',{alt:' ',className:'onlyMePrivacyCorner',height:34,src:'/images/profile/timeline/privacy_corner.png',width:34});}function r(x){var y=j.scry(x,'.photoUnit a.photo');return y.filter(function(z){return !j.scry(z,'.onlyMePrivacyCorner').length;});}function s(x,y){if(g.hasTags(u(y)))return;if(i.hasClass(x,'storyContent'))if(!k.byClass(x,'onlyMeWrap')){var z=j.create('div',{className:'onlyMeWrap'});j.appendContent(k.byClass(x,'uiStreamStory'),z);j.appendContent(z,x);x=z;}else x=k.byClass(x,'onlyMeWrap');i.addClass(x,'storyOnlyMe');if(!i.hasClass(x,'timelineRecentActivityStory'))j.setContent(j.find(y,'span.uiButtonText'),"Only Me");if(!i.hasClass(x,'storyContent')){var aa=r(x);for(var ba=0,ca=aa.length;ba<ca;++ba)j.appendContent(aa[ba],q());}if(!j.scry(x,'div.onlyMeBorder').length){var da=p();j.prependContent(x,da[0]);j.appendContent(x,da[1]);}}function t(x){if(!x)return;var y=k.byClass(x,'storyContent')||k.byClass(x,'timelineRecentActivityStory')||k.byClass(x,'timelineUnitContainer')||k.byClass(x,'fbTimelineTwoColumn');if(!y){y=j.scry(x,'^.permalink_stream .storyContent');y=y.length&&y[0];}else if(i.hasClass(y,'fbTimelineComposerUnit'))return null;return y;}function u(x){var y=j.scry(x,'*[data-oid]');if(y.length===0)return '';return y[0].getAttribute('data-oid');}var v=false,w={init:function(){if(v)return;v=true;h.subscribe('AudienceSelector/changed',function(x,y){var z=t(y.selector)||t(y.clone);if(!z)return;if(m.getOptionValue(y.option)==l.BaseValue.SELF){s(z,y.selector);}else{z=i.hasClass(z,'storyContent')?k.byClass(z,'onlyMeWrap'):z;z&&i.removeClass(z,'storyOnlyMe');}});},setOnlyMe:function(x){if(v)return;w.init();x=j.find(k.byClass(n(x),'uiSelector'),'a.uiSelectorButton');var y=t(x);y&&s(y,x);}};e.exports=w;});
__d("Composer",["event-extensions","function-extensions","Arbiter","ArbiterMixin","Button","CSS","DOM","Env","FileForm","HTML","Input","PageTransitions","Parent","Run","ServerJS","TextAreaControl","URI","URLScraper","$","copyProperties","ge","tx"],function(a,b,c,d,e,f){b('event-extensions');b('function-extensions');var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('Button'),j=b('CSS'),k=b('DOM'),l=b('Env'),m=b('FileForm'),n=b('HTML'),o=b('Input'),p=b('PageTransitions'),q=b('Parent'),r=b('Run'),s=b('ServerJS'),t=b('TextAreaControl'),u=b('URI'),v=b('URLScraper'),w=b('$'),x=b('copyProperties'),y=b('ge'),z=b('tx'),aa=1,ba=4,ca={},da=function(){var ha=k.scry(this.root,'span.linkAttachment')[0];if(!ha&&this.isMetaComposer)ha=k.scry(this.root,'span.attachmentAcceptsLink')[0];if(!ha)return;var ia=q.byTag(ha,'form');this.scraper=new v(this.input);this.scraper.subscribe('match',function(ja,ka){if(this.isMetaComposer){var la=this.form.xhpc_targetid,ma=new u('/ajax/metacomposer/attachment/link/scraper.php');ma.addQueryData({scrape_url:encodeURIComponent(ka.url),alt_scrape_url:encodeURIComponent(ka.alt_url),targetid:la.value});ia.action=ma.toString();}else{j.show(ha);ia.action='/ajax/composer/attachment/link/scraper.php?scrape_url='+encodeURIComponent(ka.url);}ia.xhpc.value=ha.id;ia.xhpc.disabled=false;ia.xhpc.click();}.bind(this));this.isMetaComposer&&this.scraper.check();},ea=function(ha){if(this.inform('submit')===false){ha.kill();return false;}if(this.submitHandler)return (new Function(this.submitHandler)).apply(this.form);};function fa(ha,ia,ja,ka,la){ca[ha.id]=this;this.root=ha;this.resetCfg=ia;this.dataSource=ka;this.lazyEndpoint=this.resetCfg&&this.resetCfg.lazyEndpoint;this.focus=k.find(ha,'div.focus_target');this.form=k.find(ha,'form.attachmentForm');this.content=k.find(ha,'div.attachmentContent');this.isMetaComposer=ja;if(this.isMetaComposer){this.messageBox=k.find(ha,'div.uiMetaComposerMessageBox');this.metaArea=k.find(ha,'div.attachmentMetaArea');this.bottomArea=k.find(ha,'div.attachmentBottomArea');this.barArea=k.find(ha,'div.attachmentBarArea');this.auxBarArea=k.find(ha,'.attachmentAuxBarArea');this.blurb=k.find(ha,'div.uiMetaComposerMessageBox div.textBlurb');this.input=k.find(ha,'div.uiMetaComposerMessageBox textarea.input');this.button=k.find(ha,'div.uiMetaComposerMessageBox label.submitBtn');this.privacy=k.find(ha,'div.uiMetaComposerMessageBox li.privacyWidget');this.boosting=k.scry(ha,'div.uiMetaComposerMessageBox li.boostingWidget');}else{this.blurb=k.find(ha,'div.uiComposerMessageBox div.textBlurb');this.input=k.find(ha,'div.uiComposerMessageBox textarea.input');this.button=k.find(ha,'div.uiComposerMessageBox label.submitBtn');this.privacy=k.find(ha,'div.uiComposerMessageBox li.privacyWidget');this.boosting=[];}Event.listen(this.form,'submit',ea.bind(this));if(this.isMetaComposer){Event.listen(this.input,'focus',this.onFocus.bind(this));if(la){if(document.activeElement===this.input)this.onFocus.bind(this).defer();}else if(q.byClass(this.input,'child_was_focused'))this.onFocus.bind(this).defer();}g.inform('xhpc/construct/'+ha.id,this,g.BEHAVIOR_STATE);}x(fa.prototype,h,{init:function(ha){this.mentionsInput=ha;if(this.mentionsInput)this.mentionsInput.subscribe('init',function(){var ia=this.mentionsInput.getTypeahead().getView();ia.subscribe(['reset','render'],function(ja){j.conditionClass(this.root,'uiComposerMention',(ja=='render'));}.bind(this));}.bind(this));da.call(this);this.inform('init',null,g.BEHAVIOR_PERSISTENT);this.setupListen();r.onBeforeUnload(this._handleUnsavedChanges.bind(this));},setupListen:function(){Event.listen(this.root,'click',this.clickHandler.bind(this));},clickHandler:function(event){var ha=event.getTarget();if(q.byClass(ha,'collapsedPostButton'))this.focusInput.bind(this).defer();},setBlurb:function(ha){k.setContent(this.blurb,ha);},setEnabled:function(ha){i.setEnabled(this.button,ha);},getEndpoint:function(){return this.form.getAttribute('action');},setEndpoint:function(ha){this.form.setAttribute('action',ha);},setLoading:function(ha){j.conditionClass(this.root,'async_saving',!!ha);},setContentVisible:function(ha){j.conditionClass(this.root,'uiComposerHideContent',!ha);},setMessageBoxVisible:function(ha){j.conditionClass(this.root,'uiComposerHideMessageBox',!ha);},setInputVisible:function(ha){j.conditionClass(this.root,'uiComposerHideInput',!ha);},setStatusBoxVisible:function(ha){j.conditionClass(this.root,'uiComposerHideStatusBox',!ha);},setTopicTaggerVisible:function(ha){j.conditionClass(this.root,'uiTagComposerHidden',!ha);},mutate:function(ha){if(this.lastComposerInput)o.setValue(this.input,o.getValue(y(this.lastComposerInput)));var ia=y(ha.xhpc);if(ia){var ja=k.scry(this.root,'.uiComposerAttachmentSelected')[0];if(ha.confirmAugmentation&&ja!==ia)return;ja&&j.removeClass(ja,'uiComposerAttachmentSelected');j.addClass(ia,'uiComposerAttachmentSelected');if(!ha.disableCache)Event.listen(ia,'click',function(la){la.stop();ha.disableCache=true;this.mutate(ha);}.bind(this));}if(!ha.keepContentAreas){this.setContentVisible(false);k.empty(this.content);if(this.isMetaComposer){this.mentionsInput&&this.mentionsInput.setAuxContent(null);k.empty(this.metaArea);k.empty(this.bottomArea);k.empty(this.barArea);k.empty(this.auxBarArea);}}if(ha.content){k.setContent(this.content,n(ha.content));this.setContentVisible(true);}if(this.isMetaComposer){ha.metaContent&&k.setContent(this.metaArea,n(ha.metaContent));ha.bottomContent&&k.setContent(this.bottomArea,n(ha.bottomContent));ha.barContent&&k.setContent(this.barArea,n(ha.barContent));ha.auxBarContent&&k.setContent(this.auxBarArea,n(ha.auxBarContent));}this.setMessageBoxVisible(!ha.messageBoxHidden);j.conditionClass(this.root,'uiComposerWhiteMessageBox',!ha.messageBoxHidden&&!ha.inputHidden&&!ha.content);this.setInputVisible(!ha.inputHidden);this.setStatusBoxVisible(!ha.statusBoxHidden);j.conditionShow(this.privacy,!ha.privacyWidgetHidden);if(this.boosting.length>0)j.conditionShow(this.boosting[0],!ha.boostingWidgetHidden);if(!ha.keepContentAreas){o.setPlaceholder(this.input,ha.placeholder);i.setLabel(this.button,ha.buttonLabel);}this.setBlurb(n(ha.blurb));if(ha.autoscrape){this.scraper&&this.scraper.enable();}else this.scraper&&this.scraper.disable();this.setEnabled(!ha.disabled);this.setTopicTaggerVisible(!ha.hideTopicTagger);this.setEndpoint(ha.endpoint);if(ha.formType==aa){this.form.setAttribute('rel','async');}else this.form.removeAttribute('rel');this.form.removeAttribute('target');if(ha.formType==ba){if(!this._fileForm){this._fileForm=new m(this.form);this._fileForm.setAllowCrossOrigin(l.allowCrossOriginComposerUpload);this._fileForm.subscribe('submit',this.setLoading.bind(this,true));this._fileForm.subscribe('failure',this.setLoading.bind(this,false));}}else if(this._fileForm){this._fileForm.destroy();this._fileForm=null;}this.submitHandler=ha.submitHandler;this.lazyEndpoint=ha.lazyEndpoint;j.addClass(this.root,'uiComposerInteracted');j.addClass(this.root,'uiComposerOpen');if(ha.messageBoxFocused){var ka=document.activeElement;if(ka===document.body||q.byClass(ka,'attachmentLink'))this.focusInput.bind(this).defer();}if(ha.inputElement){o.setValue(y(ha.inputElement),o.getValue(this.input));t.getInstance(y(ha.inputElement)).update();}else t.getInstance(this.input).update();this.lastComposerInput=ha.inputElement;g.inform('composer/mutate',this);},subscribeToMutate:function(ha){return g.subscribe('composer/mutate',function(ia,ja){if(ja===this)ha();}.bind(this));},unsubscribeFromMutate:function(ha){ha.unsubscribe();},reset:function(ha){if(this.isMetaComposer){k.empty(this.metaArea);k.empty(this.bottomArea);k.empty(this.barArea);k.empty(this.auxBarArea);}if(this.resetCfg){this.mutate(this.resetCfg);}else{var ia=k.scry(this.root,'.uiComposerAttachmentSelected')[0];if(ia)j.removeClass(ia,'uiComposerAttachmentSelected');}if(!ha){o.reset(this.input);this.mentionsInput&&this.mentionsInput.reset();this.scraper&&this.scraper.reset();}j.removeClass(this.root,'uiComposerInteracted');j.setClass(this.focus,'focus_target');this.setLoading(false);g.inform('composer/reset');},onFocus:function(){if(this.lazyEndpoint){var ha=k.find(this.root,'form.attachmentSelectForm'),ia=new u(this.lazyEndpoint);ia.addQueryData({isAugmentation:true});ha.action=ia.toString();var ja=k.scry(this.root,'.uiComposerAttachmentSelected')[0];ha.xhpc.value=ja&&ja.id;ha.xhpc.click();j.removeClass.curry(this.root,'async_saving').defer();}this.inform('focus');},focusInput:function(){o.focus(this.input);},getInput:function(){return this.input;},updateDataSourceToken:function(ha){if(this.dataSource)this.dataSource.updateToken(ha);},_handleUnsavedChanges:function(){var ha=p.getNextURI();if(ha.getQueryData().hasOwnProperty('theater'))return;if(this.input.offsetParent!==null&&!o.isEmpty(this.input)&&!(a.Dialog&&a.Dialog.getCurrent()))return "You haven't finished your post yet. Do you want to leave without finishing?";}});var ga;x(fa,{setNodeToConfigure:function(ha){ga=ha;},configure:function(ha,ia,ja){var ka=q.byClass(ga,'uiComposer').id,la=g.subscribe('xhpc/construct/'+ka,function(ma,na){(function(){la.unsubscribe();}).defer();na.mutate(ha);na.subscribe('init',function(){new s().handle(ia);new Function(ja)();if(ha.attachmentJS)new Function(ha.attachmentJS).call(na);});});},publish:function(ha,ia){ia=ia||{};ia.composer_id=ha;ia.composer=fa.getInstance(ha);ia.composer&&ia.composer.reset(false);if(ia.streamNode){ia.streamStory=ia.streamNode;}else if(ia.streamMarkup)ia.streamStory=n(ia.streamMarkup).getRootNode();g.inform('composer/publish',ia);},finish:function(ha){fa.getInstance(ha).setLoading(false);},getInstance:function(ha){var ia=q.byClass(w(ha),'uiComposer');return ia?ca[ia.id]:null;}});e.exports=fa;});
var PlaceActionLink={start_claim_link:function(a){var b=new AsyncRequest().setMethod('POST').setURI('/ajax/places/claim/start_claim.php').setData({id:a});new Dialog().setAsync(b).show();return false;},refer_claim_link:function(a){var b=new AsyncRequest().setMethod('POST').setURI('/ajax/places/claim/refer_claim.php').setData({id:a});new Dialog().setAsync(b).show();return false;}};
__d("BrokenProfilePicLogger",["Run","DOM","JSLogger"],function(a,b,c,d,e,f){var g=b("Run"),h=b("DOM"),i=b("JSLogger"),j=i.create("entities_profile_pics"),k={checkAndLog:function(l){g.onAfterLoad(function(){var m=h.find(l.parentNode,'img');if(!m.complete||(typeof m.naturalWidth!="undefined"&&m.naturalWidth===0))j.log('broken_link',{src:m.getAttribute('src')});});}};e.exports=k;});
var TimelineAggregatePost={init:function(a){Event.listen(a,'click',function(b){var c=b.getTarget();if(b.isDefaultRequested()||c.tagName==='A'||Parent.byClass(c,"_1ww"))return true;var d=Parent.byTag(c,'li'),e=DataStore.get(d,'url');AsyncRequest.bootstrap(e,d);});},initPage:function(a){Event.listen(a,'click',function(b){var c=Parent.byClass(b.getTarget(),'uiCloseButton');if(c)return;var d=Parent.byTag(b.getTarget(),'li');new AsyncRequest().setURI(DataStore.get(d,'url')).send();});},poke:function(a){ScrollableArea.poke(a);},setScrollHeight:function(a){var b=DOM.find(a,'.sArea');Style.set(b,'height',a.offsetHeight+'px');}};
__d("TimelineDrag",["event-extensions","ArbiterMixin","Class","Locale","Style","Vector","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('ArbiterMixin'),h=b('Class'),i=b('Locale'),j=b('Style'),k=b('Vector'),l=b('copyProperties');function m(n,o,p){p=p||{};this._listenOn=p.listenOn;this._offsetInput=o;this._defaultOffset=p.default_offset;this._killClicks=p.killClicks;this._vertical=true;this._RTLXSwitch=false;this.setPicture(n,p);}l(m.prototype,g,{setPicture:function(n,o){if(!n)return false;o=o||{};this._picture=n;this._defaultOffset=o.default_offset;if(o.vertical!==undefined)this._vertical=o.vertical;if(this._vertical){if(o.height)this._containerHeight=o.height;this._offsetType='top';this._eventCoord='y';}else{if(o.width)this._containerWidth=o.width;this._RTLXSwitch=i.isRTL();this._offsetType='left';this._eventCoord='x';}if(this._picture.complete){this._initialLoad();}else this._loadListener=Event.listen(this._picture,'load',function(){this._loadListener.remove();this._initialLoad();}.bind(this));},destroy:function(){this._stopDrag();this._saveOffset();this._mousedown&&this._mousedown.remove();this._onclick&&this._onclick.remove();this._loadListener&&this._loadListener.remove();},_initialLoad:function(){var n=this._listenOn?this._listenOn:this._picture;this._mousedown&&this._mousedown.remove();this._mousedown=Event.listen(n,'mousedown',this._onMouseDown.bind(this));if(this._vertical){this._maxOffset=this._containerHeight-this._picture.offsetHeight;}else this._maxOffset=this._containerWidth-this._picture.width;if(this._defaultOffset!==undefined)this._setOffset(this._defaultOffset);this._onclick&&this._onclick.remove();if(this._killClicks)this._onclick=Event.listen(n,'click',this._onClick.bind(this));this._saveOffset();},_onClick:function(event){event.kill();},_onMouseDown:function(event){var n=parseInt(j.get(this._picture,this._offsetType),10)||0;this._pictureStartDragOffset=n-k.getEventPosition(event)[this._eventCoord];this._startDrag();event.kill();},_startDrag:function(){if(!this._dragStarted){this.inform('startdrag',this);this._dragTokens=[Event.listen(document.documentElement,'mouseup',this._onMouseUp.bind(this)),Event.listen(document.documentElement,'mousemove',this._onMouseMove.bind(this))];this._dragStarted=true;}},_saveOffset:function(){var n=parseInt(j.get(this._picture,this._offsetType),10);if(this._RTLXSwitch){this._offsetInput.value=n+this._containerWidth-this._picture.offsetWidth;}else this._offsetInput.value=n;},_stopDrag:function(){if(this._dragStarted){this.inform('stopdrag',this);this._dragStarted=false;this._dragTokens.forEach(function(n){n.remove();});this._saveOffset();}},_onMouseUp:function(event){this._stopDrag();event.kill();},_setOffset:function(n){if(this._RTLXSwitch){n=Math.max(0,Math.min(n,-this._maxOffset));}else n=Math.min(0,Math.max(n,this._maxOffset));j.set(this._picture,this._offsetType,n+'px');},_onMouseMove:function(event){this._setOffset(this._pictureStartDragOffset+k.getEventPosition(event)[this._eventCoord]);event.kill();}});e.exports=m;});
__d("TimelineCover",["Button","CSS","DOM","HTML","Parent","DOMScroll","Vector","TimelineController","TimelineDrag","Style","$","copyProperties","ge"],function(a,b,c,d,e,f){var g=b('Button'),h=b('CSS'),i=b('DOM'),j=b('HTML'),k=b('Parent'),l=b('DOMScroll'),m=b('Vector'),n=b('TimelineController'),o=b('TimelineDrag'),p=b('Style'),q=b('$'),r=b('copyProperties'),s=b('ge');function t(u,v,w){this.root=q('fbProfileCover');this._parentSection=k.byClass(this.root,'fbTimelineSection');this._coverHeight=v;this.cover=i.find(this.root,'.cover');t.instance=this;this.previewing=w;this.editing=false;if(w){this.editMode();this.updateCoverImage(w);}else if(this.cover.getAttribute('data-collapse'))this._expandCover(parseInt(this.cover.getAttribute('data-collapse'),10));n.register(n.COVER,this);}t.instance=null;t.getInstance=function(){return t.instance;};r(t.prototype,{showLoadingIndicator:function(){var u=s('fbCoverImageContainer');if(u)h.addClass(u,'opaquedLoading');},hideLoadingIndicator:function(){var u=s('fbCoverImageContainer');if(u)h.removeClass(u,'opaquedLoading');},editMode:function(){g.setEnabled(i.find(this.root,'label.cancelButton'),true);g.setEnabled(i.find(this.root,'label.saveButton'),true);this.hideLoadingIndicator();this._coverImage=i.scry(this.root,'.coverImage')[0];var u=i.scry(this._coverImage,'.coverWrap')[0];if(u)this._originalOffset=p.get(i.find(u,'.coverPhotoImg'),'top');h.addClass(this._parentSection,'fbEditCover');l.scrollTo(this.root);if(this.previewing){i.remove(this._coverImage);h.show(this._coverImage);}var v=i.scry(this._coverImage,'.coverPhotoImg')[0];if(v)this._createDragger();this.editing=true;},_expandCover:function(u){u-=1;this.cover.style.marginTop='0px';if(u!=m.getScrollPosition().y){window.scrollBy(0,u);n.coverHasExpanded(u);}},_exitEditMode:function(){if(this._timelineDrag){this._timelineDrag.destroy();this._timelineDrag=null;}i.find(this.root,'input.hiddenPhotoID').value=null;i.find(this.root,'input.hiddenVideoID').value=null;g.setEnabled(i.find(this.root,'label.cancelButton'),false);g.setEnabled(i.find(this.root,'label.saveButton'),false);h.removeClass(this._parentSection,'fbEditCover');this.hideLoadingIndicator();this.previewing=false;},_createDragger:function(){this._timelineDrag=new o(i.find(this.root,'.coverImage .coverPhotoImg'),i.find(this.root,'input.photoOffsetInput'),{height:this._coverHeight,listenOn:this.cover,vertical:true,killClicks:true});},updateCoverImage:function(u,v,w){this.videoID=w;if(v)this.editMode();i.find(this.root,'input.hiddenPhotoID').value=u;i.find(this.root,'input.hiddenVideoID').value=w||null;g.setEnabled(i.find(this.root,'label.saveButton'),true);if(v)i.replace(i.find(this.root,'.coverImage'),j(v));if(this._timelineDrag){this._timelineDrag.setPicture(i.find(i.find(this.root,'.coverImage'),'.coverPhotoImg'));}else this._createDragger();},cancelUpdate:function(){i.remove(i.scry(this.root,'.coverImage')[0]);i.prependContent(this.cover,this._coverImage);if(this._originalOffset!==undefined)p.set(i.find(this._coverImage,'.coverPhotoImg'),'top',this._originalOffset);this._exitEditMode();},saveComplete:function(){this._coverImage=i.scry(this.root,'.coverImage')[0];this._exitEditMode();},isInEditMode:function(){return this.editing;}});e.exports=t;});
requireLazy(['Selector'],function(a){add_properties('__behaviors',{});if(__behaviors.TimelineCurationControl)return;__behaviors.TimelineCurationControl=true;a.subscribe('open',function(b,c){var d=c.selector,e=c.clone||d,f=Parent.byClass(e,'fbTimelineCurationControl');if(f){CSS.addClass(f,'editControlsMenuOpen');var g=a.subscribe('close',function(h,i){if(i.selector==d){a.unsubscribe(g);CSS.removeClass.curry(f,'editControlsMenuOpen').defer();}});}});});
__d("TimelineUnitSelector",["DOMQuery"],function(a,b,c,d,e,f){var g=b('DOMQuery'),h={getUnitsWithTime:function(i){return g.scry(i,'div.timelineUnitContainer').filter(function(j){return (j.parentNode.parentNode===i&&j.getAttribute('data-time'));});}};e.exports=h;});
__d("TimelineComposerUtilities",["event-extensions","Arbiter","Bootloader","CSS","DOM","DOMQuery","Parent","TimelineUnitSelector","Vector","cx","csx"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('Bootloader'),i=b('CSS'),j=b('DOM'),k=b('DOMQuery'),l=b('Parent'),m=b('TimelineUnitSelector'),n=b('Vector'),o=b('cx'),p=b('csx'),q=86400*31,r=86400000,s={listenToSetEstimatedDate:function(t,u){return g.subscribe('ComposerXTimelineTagger/init',function(v,w){if(k.contains(t,w.datePickerElement)){s.setEstimatedDate(w.datePickerInstance,u());w.composerTimelineTagger.switchToTagger('date');}});},listenToSetEstimatedDateOld:function(t,u){return g.subscribe('TimelineBackdatedComposerTagger/initialized',function(event,v){if(v.composer===t)v.date_picker.subscribe('initialized',function(w,x){s.setEstimatedDate(x,u());});});},listenToPublish:function(t,u){if(t.root)t=t.root;return g.subscribe('composer/publish',function(event,v){if(v.composer_id===t.id)h.loadModules(['TimelineStoryPublisher'],function(w){w.publish(v);u&&u();});});},listenToAnotherComposerOpen:function(t,u){return g.subscribe('composer/mutate',function(v,w){if(w!==t)u();});},listenToCancel:function(t,u){return Event.listen(t,'click',function(event){if(l.byClass(event.getTarget(),"_306"))u();});},listenToCancelOld:function(t,u){return Event.listen(t,'click',function(event){l.byClass(event.getTarget(),'cancelBtn')&&u();});},hidePlaceIfAttachmentsTooTall:function(t){var u=k.find(t,"._2_3"),v=n.getElementDimensions(u).y;if(v>50)i.hide(k.find(u,"._mg"));},hidePlaceIfAttachmentsTooTallOld:function(t){var u=j.find(t,'ul.fbTimelineComposerAttachments'),v=n.getElementDimensions(u).y;if(v>50){var w=l.byTag(j.scry(u,'span.placeAttachment')[0],'li');w&&i.hide(w);}},setEstimatedDate:function(t,u){var v,w;if(u&&i.hasClass(u,'fbTimelineCapsule')){v=u.getAttribute('data-start');w=u.getAttribute('data-end');if(v&&w){var x=new Date(w*1000);if(w-v>2*q){t.setDate(x.getFullYear());}else t.setDate(x.getFullYear(),x.getMonth()+1);}return;}var y=l.byClass(u,'fbTimelineCapsule');if(y){v=y.getAttribute('data-start');w=y.getAttribute('data-end');var z=n.getElementPosition(u).y,aa=[w,null],ba=[v,null],ca=m.getUnitsWithTime(y);for(var da=0;da<ca.length;da++){var ea=ca[da],fa=j.scry(ea.parentNode,'.spinePointer')[0];if(!fa)continue;var ga=n.getElementPosition(fa).y;if(ga<=z){if(!aa[1]||ga>aa[1])aa=[ea.getAttribute('data-time'),ga];}else if(!ba[1]||ga<ba[1])ba=[ea.getAttribute('data-time'),ga];}if(aa[0]!==null&&ba[0]!==null){var ha=Math.round((parseInt(aa[0],10)+parseInt(ba[0],10))/2)*1000;ha=Math.min(new Date()-r,ha);t.setDateWithTimestamp(ha);}}},showMLEFlyout:function(t){var u=j.scry(document,'a.fbTimelineSpine').length===0,v=function(w){w.showMLEFlyout(t);};if(u){h.loadModules(['TimelineSpinelessComposer'],v);}else h.loadModules(['TimelineComposer'],v);}};e.exports=s;});
__d("TimelineBackdatedComposer",["Arbiter","Bootloader","CSS","DOM","LayerHideOnBlur","Run","TimelineComposerUtilities","TimelineNavigation"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('Bootloader'),i=b('CSS'),j=b('DOM'),k=b('LayerHideOnBlur'),l=b('Run'),m=b('TimelineComposerUtilities'),n=b('TimelineNavigation'),o;function p(){q();r();}function q(){o.hide();}function r(){h.loadModules(['TimelineMLE'],function(t){var u=t.getFlyout();if(u&&i.hasClass(u.getContext(),'backdatedDot'))t.hideFlyout();});}var s={init:function(t,u){o=u;var v=[m.listenToPublish(t,p),m.listenToAnotherComposerOpen(t,p),m.listenToSetEstimatedDateOld(t,o.getContext.bind(o)),t.subscribeToMutate(function(){var x=!j.scry(t.root,'.cancelBtn')[0]||j.scry(t.root,'.attachmentLifeEvents')[0];if(x){o.enableBehavior(k);}else o.disableBehavior(k);}),g.subscribe('TimelineMLE/mleFlyoutShown',function(x,y){if(i.hasClass(y.getContext(),'backdatedDot')){q();}else p();}),g.subscribe(n.UPDATE_PAGE,p)],w=m.listenToCancelOld(o.getContent(),p);l.onLeave(function(){v.forEach(g.unsubscribe.bind(g));v=[];w.remove();w=null;});g.inform('TimelineBackdatedComposer/initialized');},getFlyout:function(){return o;}};e.exports=a.TimelineBackdatedComposer||s;});
__d("TimelineSpine",["array-extensions","event-extensions","Arbiter","AsyncRequest","Bootloader","Composer","ComposerXController","CSS","DOM","Layer","LayerHideOnBlur","Parent","Run","TimelineBackdatedComposer","TimelineComposerUtilities","copyProperties"],function(a,b,c,d,e,f){b('array-extensions');b('event-extensions');var g=b('Arbiter'),h=b('AsyncRequest'),i=b('Bootloader'),j=b('Composer'),k=b('ComposerXController'),l=b('CSS'),m=b('DOM'),n=b('Layer'),o=b('LayerHideOnBlur'),p=b('Parent'),q=b('Run'),r=b('TimelineBackdatedComposer'),s=b('TimelineComposerUtilities'),t=b('copyProperties');function u(){}t(u,{OFFSET_Y:12,composerFlyout:null,composerRoot:null,mleFlyout:null,dot:null,loadComposerFlyoutCalled:false,showComposerFlyout:function(v){var w=u.composerFlyout;if(!w){u.loadComposerFlyout(v);u.showComposerFlyoutOnLoad=true;return;}if(u.composerRoot){k.reset(u.composerRoot);s.hidePlaceIfAttachmentsTooTall(u.composerRoot);}else{var x=m.scry(w.getContent(),'div.fbTimelineBackdatedComposer')[0],y=j.getInstance(x);if(y){y.reset();l.removeClass(y.root,'uiComposerOpen');}s.hidePlaceIfAttachmentsTooTallOld(x);}w.enableBehavior(o).setContext(u.dot).updatePosition();w.show();},loadComposerFlyout:function(v){if(u.loadComposerFlyoutCalled||u.composerFlyout)return;u.loadComposerFlyoutCalled=true;q.onLeave(function(){u.loadComposerFlyoutCalled=false;u.composerFlyout=null;u.composerRoot=null;}.bind(this));new h().setURI('/ajax/timeline/backdated_composer.php').setData({targetid:v}).setRelativeTo(u.dot||document.body).send();var w=g.subscribe('TimelineBackdatedComposer/initialized',function(x,y){if(y){u.composerFlyout=y.getFlyout();u.composerRoot=y.getComposerRoot();}else u.composerFlyout=r.getFlyout();if(u.showComposerFlyoutOnLoad)u.showComposerFlyout(v);u._handleComposerFlyoutDismissed();w.unsubscribe();});},showMLEFlyout:function(v){u.mleFlyout=v;v.setContext(u.dot).show();u.composerFlyout.hide();},_handleComposerFlyoutDismissed:function(){var v=n.subscribe('hide',function(w,x){if(u.dot&&x.getContext)if(x.getContext()===u.dot&&!u.mleFlyout){u._hideDot();}else if(x===u.mleFlyout){u.mleFlyout=null;u._hideDot();}});q.onLeave(function(){n.unsubscribe(v);}.bind(this));},_hideDot:function(){m.remove(u.dot);u.dot=null;}});t(u.prototype,{init:function(v,w){this._spine=v;this._plus=m.find(v,'.spineHoverPlus');this._capsule=p.byClass(v,'fbTimelineCapsule');this._targetid=w;var x=[Event.listen(v,'mouseenter',function(event){u.loadComposerFlyout(this._targetid);this._spineHeight=v.offsetHeight;}.bind(this)),Event.listen(v,'mousemove',this._mouseMoved.bind(this)),Event.listen(v,'click',this._spineClicked.bind(this))];l.addClass(this._plus,'spineHoverPlusActive');q.onLeave(function(){while(x.length)x.pop().remove();}.bind(this));},_mouseMoved:function(event){var v=event.offsetY||event.layerY,w=event.getTarget();if(w!==this._spine)v=w.offsetTop+v;v=Math.min(Math.max(v-u.OFFSET_Y,0),this._spineHeight);this._plus.style.top=v+'px';},_spineClicked:function(event){if(u.mleFlyout){i.loadModules(['TimelineMLE'],function(v){v.hideFlyout();});return;}u.dot&&m.remove(u.dot);u.dot=m.create('i',{className:'backdatedDot'});u.dot.style.top=(this._plus.offsetTop-1)+'px';m.appendContent(this._spine,u.dot);event.stop();u.showComposerFlyout(this._targetid);}});e.exports=a.TimelineSpine||u;});
__d("legacy:TimelineSpine",["TimelineSpine"],function(a,b,c,d){a.TimelineSpine=b('TimelineSpine');},3);
__d("TimelineButtonListener",["event-extensions","CSS","Parent","Run","$"],function(a,b,c,d,e,f){b('event-extensions');var g=b('CSS'),h=b('Parent'),i=b('Run'),j=b('$'),k=null,l={focusListener:function(event){var m=event.getTarget(),n=h.byClass(m,'fbTimelineCurationControl');if(n){g.addClass(n,'editControlsShowButtons');var o=Event.listen(m,'focusout',function(event){g.removeClass(n,'editControlsShowButtons');o.remove();});}},initListener:function(){if(!k){k=Event.listen(j('content'),'focusin',this.focusListener);i.onLeave(function(){k.unsubscribe();k=null;});}}};e.exports=l;});
__d("TimelineCapsule",["Arbiter","CSS","DataStore","DOM","DOMQuery","DOMScroll","Parent","TimelineConstants","TimelineLegacySections","UserAgent","Vector","$","createArrayFrom","isEmpty","requestAnimationFrame"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('DataStore'),j=b('DOM'),k=b('DOMQuery'),l=b('DOMScroll'),m=b('Parent'),n=b('TimelineConstants'),o=b('TimelineLegacySections'),p=b('UserAgent'),q=b('Vector'),r=b('$'),s=b('createArrayFrom'),t=b('isEmpty'),u=b('requestAnimationFrame'),v=(function(){var w=45,x=15,y='use',z='update',aa={},ba={};function ca(pa){return h.hasClass(pa,'fbTimelineBalancer');}function da(pa){return pa.getAttribute('data-spine');}function ea(pa){return h.hasClass(pa,'placeholderUnit');}function fa(pa,qa){if(qa)return (i.get(n.DS_SIDEORG,pa.id)||pa.getAttribute('data-side'));return pa.getAttribute('data-side');}var ga=function(pa,qa){if(p.ie()<=6){ga=function(ra,sa){i.set(n.DS_SIDEORG,ra.id,fa(ra,true));ra.setAttribute('data-side',sa);h.removeClass(ra,'leftColumn');h.removeClass(ra,'rightColumn');h.addClass(ra,sa=='l'?'leftColumn':'rightColumn');};}else ga=function(ra,sa){i.set(n.DS_SIDEORG,ra.id,fa(ra,true));ra.setAttribute('data-side',sa);};ga(pa,qa);};function ha(pa){return pa.getAttribute('data-size');}function ia(pa){if(h.hasClass(pa,'fbTimelineOneColumn')&&pa.prevSibling&&h.hasClass(pa.prevSibling,'fbTimelineOneColumn'))return x*2;if(h.hasClass(pa,'fbTimelineIndeterminateContent'))return 0;return x;}function ja(pa,qa){var ra=0;if(h.shown(pa)&&!h.hasClass(pa,'placeholderUnit'))if(qa===y){ra=i.get(n.DS_HEIGHT,pa.id,null);if(ra===null)ra=pa.getAttribute('data-calculatedheight');}else ra=pa.offsetHeight+ia(pa);if(qa===y&&ra===null)ra=300;i.set(n.DS_HEIGHT,pa.id,parseInt(ra,10));}function ka(pa){var qa=i.get(n.DS_HEIGHT,pa.id,null);return qa;}function la(pa,qa){if(ha(qa)=='2'){return 0;}else if(fa(qa)=='r'){return pa+ka(qa);}else return pa-ka(qa);}function ma(pa){for(var qa=0;qa<pa.childNodes.length;qa++){var ra=pa.childNodes[qa];if(!ra.getAttribute('data-endmarker'))continue;var sa=ra.getAttribute('data-endmarker'),ta=ra.getAttribute('data-pageindex'),ua=function(){i.set(n.DS_LOADED,pa.id,ta);j.remove(ra);g.inform(n.SECTION_FULLY_LOADED,{scrubberKey:sa,pageIndex:ta,capsuleID:pa.id,childCount:pa.childNodes.length});};if(o.get(sa)){ua();}else var va=g.subscribe(n.SECTION_REGISTERED,function(wa,xa){if(xa.scrubberKey===sa){ua();va.unsubscribe();}});break;}g.inform('TimelineCapsule/balanced',{capsule:pa});}function na(pa){if(t(aa[pa.id]))return;var qa=ca(pa)?pa.firstChild:pa,ra=qa.childNodes.length,sa={},ta={},ua,va=x,wa=x,xa,ya=[];for(var za=0;za<ra;za++){ua=qa.childNodes[za];if(h.hasClass(ua,'fbTimelineUnit')){xa=k.scry(ua,'div.timelineUnitContainer')[0];if(xa)ta[ua.id]=xa.getAttribute('data-time');if(!ea(ua)&&h.shown(ua)){if(ha(ua)=='2'){sa[ua.id]=Math.max(va,wa);va=wa=sa[ua.id]+ka(ua);}else if(fa(ua)=='r'){sa[ua.id]=wa;wa+=ka(ua);}else{sa[ua.id]=va;va+=ka(ua);}if(fa(ua,true)=='l'||ha(ua)=='2')ya.push(ua.id);}}}for(za=0;za<ya.length-1;++za){var ab=ya[za],bb=ya[za+1],cb=sa[ab]+w,db=sa[bb];for(var eb in aa[pa.id]){if(cb>db)break;var fb=aa[pa.id][eb];if(h.shown(fb))continue;if(ta[eb]<=ta[ab]&&ta[eb]>ta[bb]){fb.style.top=cb+"px";cb+=w;h.show(fb);}}}}function oa(pa,qa){var ra=m.byAttribute(pa,'data-size');if(ra){if(h.hasClass(pa.parentNode,'timelineReportContent')){qa(pa);}else qa(ra);v.balanceCapsule(m.byClass(ra,'fbTimelineCapsule'));}}return {removeUnit:function(pa){oa(pa,function(qa){j.remove(qa);});},hideUnit:function(pa){oa(pa,function(qa){h.addClass(qa,'fbTimelineColumnHidden');});},undoHideUnit:function(pa,qa){j.remove(m.byClass(qa,'hiddenText'));oa(pa,function(ra){h.removeClass(ra,'fbTimelineColumnHidden');});},unplacehold:function(pa){var qa=r(pa);qa.style.top=null;h.removeClass(qa,'visiblePlaceholder');h.removeClass(qa,'placeholder');var ra=m.byClass(qa,'fbTimelineCapsule');delete aa[ra.id][pa];v.balanceCapsule(ra);},scrollToCapsule:function(pa){if(!ba.hasOwnProperty(pa.id)){var qa=q.getElementPosition(pa.parentNode);l.scrollTo(new q(q.getScrollPosition().x,qa.y-n.SUBSECTION_SCROLL_TO_OFFSET,'document'));ba[pa.id]=true;}},balanceCapsuleFromChild:function(pa,qa){v.balanceCapsule(m.byClass(pa,'fbTimelineCapsule'),qa);},balanceCapsule:function(pa,qa){if(!pa)return;var ra=0,sa,ta=document.createDocumentFragment(),ua=[],va=[],wa=[],xa=false,ya=qa&&qa.heights_action;if(qa&&qa.tail_balance)i.set(n.DS_TAILBALANCE,pa.id,qa.tail_balance);if(ya!==z&&(p.chrome()||p.safari()))h.toggleClass(pa,'webkitFix');for(var za=0;za<pa.childNodes.length;za++){sa=pa.childNodes[za];if(da(sa)){continue;}else if(ca(sa)){s(sa.firstChild.childNodes).forEach(function(hb){ja(hb,ya);});continue;}ja(sa,ya);if(fa(sa,true)=='r'){va.push(sa);}else ua.push(sa);wa.push(sa);if(ha(sa)!='2')if((ra>0&&fa(sa)=='r')||(ra<0&&fa(sa)=='l'))xa=true;ra=la(ra,sa);}var ab=[],bb=[],cb=[];k.scry(pa,'li.fbTimelineBalancer').forEach(function(hb){var ib=s(hb.firstChild.childNodes);if(hb.getAttribute('data-nonunits')){cb=cb.concat(ib);}else if(fa(hb)=='left'){ab=ab.concat(ib);}else if(fa(hb)=='right')bb=bb.concat(ib);});if(xa){pa.style.minHeight=pa.offsetHeight;ua.forEach(function(hb){if(ha(hb)!='2')ga(hb,'l');});va.forEach(function(hb){if(ha(hb)!='2')ga(hb,'r');});var db=j.create('li',{className:'fbTimelineBalancer'},j.create('ol',null,ua));db.setAttribute('data-side','left');j.prependContent(pa,db);ab=ua.concat(ab);var eb=j.create('li',{className:'fbTimelineBalancer'},j.create('ol',null,va));eb.setAttribute('data-side','right');j.prependContent(pa,eb);bb=va.concat(bb);ra=0;}while((ra>=0&&ab.length)||(ra<0&&bb.length)){if(ra>=0){sa=ab.shift();}else sa=bb.shift();ta.appendChild(sa);ra=la(ra,sa);}while(cb.length)ta.appendChild(cb.shift());pa.appendChild(ta);k.scry(pa,'li.fbTimelineBalancer').forEach(function(hb){if(!hb.firstChild.childNodes.length)j.remove(hb);});var fb=(qa&&qa.tail_balance)||i.get(n.DS_TAILBALANCE,pa.id);if(fb)ra=v.tailBalance(pa,ra,fb);if(xa){wa.forEach(function(hb){if(hb.parentNode!==pa){pa.appendChild(hb);ra=la(ra,hb);}});pa.style.minHeight=null;}var gb=m.byClass(pa,'fbTimelineSection');if(gb)i.set(n.DS_COLUMN_HEIGHT_DIFFERENTIAL,gb.id,ra);aa[pa.id]={};k.scry(pa,'li.placeholderUnit').forEach(function(hb){aa[pa.id][hb.id]=hb;});na(pa);ma(pa);if(ya===y){qa.heights_action=z;u(function(){u(v.balanceCapsule.curry(pa,qa));});}},tailBalance:function(pa,qa,ra){if(!pa)return qa;var sa=[],ta=[],ua=[],va=[];k.scry(pa,'li.fbTimelineBalancer').forEach(function(xa){var ya=s(xa.firstChild.childNodes);if(xa.getAttribute('data-nonunits')){va=va.concat(ya);}else if(fa(xa)=='left'){ta=ta.concat(ya);}else if(fa(xa)=='right')ua=ua.concat(ya);sa=sa.concat(ya);});if((ra==n.FIXED_SIDE_RIGHT&&ta.length)||(ra==n.FIXED_SIDE_LEFT&&ua.length))return qa;var wa=document.createDocumentFragment();if(sa)while(sa.length){if(ra!=n.FIXED_SIDE_NONE)if(ha(sa[0])!='2')if(qa>=0){ga(sa[0],'l');}else ga(sa[0],'r');qa=la(qa,sa[0]);wa.appendChild(sa.shift());}pa.appendChild(wa);k.scry(pa,'li.fbTimelineBalancer').forEach(function(xa){if(!xa.firstChild.childNodes.length)j.remove(xa);});return qa;}};})();e.exports=a.TimelineCapsule||v;});
__d("TimelineCapsuleUtilities",["CSS"],function(a,b,c,d,e,f){var g=b('CSS'),h={setFirstUnit:function(i){var j=true;for(var k=0;k<i.childNodes.length;++k){var l=i.childNodes[k];if(l.id.indexOf('tl_unit_')===0)if(j){j=false;g.addClass(l,'firstUnit');}else{g.removeClass(l,'firstUnit');break;}}}};e.exports=h;});
__d("TimelineComposer",["Arbiter","Bootloader","CSS","DOM","Parent","Run","TimelineCapsule","TimelineCapsuleUtilities","TimelineComposerUtilities","$","cx"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('Bootloader'),i=b('CSS'),j=b('DOM'),k=b('Parent'),l=b('Run'),m=b('TimelineCapsule'),n=b('TimelineCapsuleUtilities'),o=b('TimelineComposerUtilities'),p=b('$'),q=b('cx'),r;function s(x){if(x.isScheduledPost||x.isOGPost)return;if(!x.streamStory){window.location.reload();return;}if(x.backdatedTime){h.loadModules(['TimelineStoryPublisher'],function(y){y.publish(x);});return;}w.renderCapsuleBasedStory(r,x.streamStory);}function t(){var x=k.byClass(r,'fbTimelineTwoColumn');return j.find(x,'.spinePointer');}function u(x){var y=v();i.show(y);var z=x.subscribe('hide',function(){i.hide(y);x.unsubscribe(z);});}function v(){var x=k.byClass(r,'fbTimelineTwoColumn'),y=j.scry(x,'div.composerVeil');if(y.length!==1)y=j.appendContent(x,j.create('div',{className:'composerVeil hidden_elem'}));return y[0];}var w={init:function(x){r=p(x);var y=g.subscribe('composer/publish',function(event,z){if(z.composer_id===r.id)s(z);});l.onLeave(y.unsubscribe.bind(y));if(i.hasClass(r,"_mj")){o.hidePlaceIfAttachmentsTooTall(r);}else o.hidePlaceIfAttachmentsTooTallOld(r);},showMLEFlyout:function(x){x.setContext(t()).show();u(x);},renderCapsuleBasedStory:function(x,y){var z=k.byClass(x,'fbTimelineCapsule');if(!z)return;var aa=k.byClass(x,'timelineUnitContainer').parentNode;if(aa.nextSibling.getAttribute('data-spine'))aa=aa.nextSibling;var ba=j.insertAfter(aa,y)[0];h.loadModules(['Animation'],function(ca){ca(ba.firstChild).from('backgroundColor','#fff8dd').to('backgroundColor','#fff').duration(2000).ease(ca.ease.both).go();});n.setFirstUnit(z);m.balanceCapsule(z);}};e.exports=a.TimelineComposer||w;});
__d("TimelineSmartInsert",["CSS","DOM","Run","UserAgent","Vector"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i=b('Run'),j=b('UserAgent'),k=b('Vector'),l=false,m=false;function n(){if(m)return;i.onLeave(o);m=true;}function o(){l=false;m=false;}var p={BUFFER:100,run:function(q,r){n();if(!l||j.ie()<=8){r();return;}var s=q.offsetHeight;r();var t=q.offsetHeight;if(t-s!==0&&k.getElementPosition(q).y+s<k.getScrollPosition().y+p.BUFFER)window.scrollBy(0,t-s);},enable:function(){l=true;}};e.exports=p;});
__d("TimelineContentLoader",["event-extensions","function-extensions","Arbiter","CSS","DOM","DOMScroll","OnVisible","ScrollingPager","TimelineConstants","TimelineController","TimelineLegacySections","TimelineSmartInsert","TimelineURI","UIPagelet","UserAgent","Vector","$","copyProperties","createArrayFrom","csx","debounce","ge","startsWith","tx","userAction"],function(a,b,c,d,e,f){b('event-extensions');b('function-extensions');var g=b('Arbiter'),h=b('CSS'),i=b('DOM'),j=b('DOMScroll'),k=b('OnVisible'),l=b('ScrollingPager'),m=b('TimelineConstants'),n=b('TimelineController'),o=b('TimelineLegacySections'),p=b('TimelineSmartInsert'),q=b('TimelineURI'),r=b('UIPagelet'),s=b('UserAgent'),t=b('Vector'),u=b('$'),v=b('copyProperties'),w=b('createArrayFrom'),x=b('csx'),y=b('debounce'),z=b('ge'),aa=b('startsWith'),ba=b('tx'),ca=b('userAction'),da=false,ea=false,fa,ga=null,ha={},ia=[],ja=[],ka={},la={},ma={},na={},oa=null,pa=null,qa=false,ra=null;function sa(bb,cb,db,eb,fb){this.node=bb;this.loaded=eb;this.canScrollLoad=true;this.canUnload=cb!=ab.RECENT;this.scrubberKey=cb;this.historicUnitCount=fb;this._pageletLoadData=db;this._expandPageletLoadData={};}v(sa.prototype,{load:function(bb){if(this.loaded)return;var cb=this._pageletLoadData;g.inform(m.SECTION_LOADING,{data:cb,scrubberKey:this.scrubberKey});this.loaded=true;h.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');h.removeClass(this.node,'fbTimelineTimePeriodSuppressed');var db='ProfileTimelineSectionPagelet';if(this.scrubberKey==ab.WAY_BACK)db='ProfileTimelineRemainingYearsPagelet';cb.time_cutoff=ab.getTimeCutoff();cb.highlight_unit_data=bb;cb.parent_key=this.parentKey;cb.force_no_friend_activity=qa;h.addClass(this.node,'fbTimelineSectionLoading');if(this.canUnload&&ea){var eb=this.node.firstChild.cloneNode(true);h.hide(eb);i.insertAfter(this.node,eb);}else this.canScrollLoad=false;ma[this.scrubberKey]=r.loadFromEndpoint(db,this.node.id,cb,{usePipe:true,jsNonblock:true,constHeight:true});za(this.scrubberKey);},preload:function(){h.addClass(this.node,'fbTimelineTimePeriodSuppressed');h.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');var bb=i.find(this.node,'span.sectionLabel');if(bb.getAttribute('data-original-label')){i.setContent(bb,bb.getAttribute('data-original-label'));bb.removeAttribute('data-original-label');}},unload:function(){if(!this.loaded||!this.canUnload)return;this.loaded=false;ma[this.scrubberKey]&&ma[this.scrubberKey].cancel();h.addClass(this.node,'fbTimelineTimePeriodUnexpanded');h.removeClass(this.node,'fbTimelineTimePeriodSuppressed');if(this.node.nextSibling&&h.hasClass(this.node.nextSibling,'fbTimelineSection')){i.setContent(this.node,this.node.nextSibling);h.show(this.node.firstChild);}else i.empty(this.node);this.deactivateScrollLoad();},activateScrollLoad:function(){this.canScrollLoad=true;h.removeClass(this.node,'fbTimelineTimePeriodSuppressed');h.addClass(this.node,'fbTimelineTimePeriodUnexpanded');la[this.scrubberKey]&&la[this.scrubberKey].reset();},deactivateScrollLoad:function(){if(!this.loaded){this.canScrollLoad=false;h.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');h.addClass(this.node,'fbTimelineTimePeriodSuppressed');la[this.scrubberKey]&&la[this.scrubberKey].remove();}},setExpandLoadData:function(bb){this._expandPageletLoadData=bb;return this;},expandSubSections:function(){if(this.subSections.length)ab.navigateToSection(this.subSections[0].scrubberKey);},expand:function(bb){if(!this.loaded)return;pa.add_event('expand_'+this.scrubberKey);var cb=i.find(this.node,'.fbTimelineSectionExpander');h.addClass(cb.firstChild,'async_saving');bb&&h.addClass(bb,'async_saving');this._expandPageletLoadData.time_cutoff=ab.getTimeCutoff();ab.navigateToSection(this.scrubberKey);i.scry(this.node,'ol.fbTimelineCapsule').forEach(i.remove);this._expandPageletLoadData.new_expand=true;ma[this.scrubberKey]&&ma[this.scrubberKey].cancel();ma[this.scrubberKey]=r.loadFromEndpoint('ProfileTimelineSectionPagelet',cb.id,this._expandPageletLoadData,{usePipe:true,jsNonblock:true,constHeight:true});},isPermalinkPeriod:function(){return this._pageletLoadData.is_permalink_period;}});function ta(){if(da)return;n.register(n.CONTENT,ab);pa=ca('timeline').uai('init','scrubber',false);da=true;if(s.ie()<=7)ea=true;}var ua=y(function(bb,cb,db){var eb=o.get(bb).historicUnitCount;cb-=eb;db-=1;if(eb==-1||db<=0||cb<0)return;var fb=ab.getNextSectionKey(bb);if(fb){o.get(fb).load();ua(fb,cb,db);}},500);function va(bb,cb,db,eb){var fb=ab.getNextSectionKey(cb);if(fb){la[fb]=new k(bb,wa.curry(fb,bb),false,db||1000);}else if(cb!==ab.WAY_BACK){eb=eb?eb:0;if(eb>80)return null;va.curry(bb,cb,db,eb+1).defer(250);}}function wa(bb,cb){var db=o.get(bb);if(db&&db.canScrollLoad){pa.add_event("scroll_load_"+bb);if(ea){db.preload();}else{db.load();if(ra)ua(bb,ra.required_units,ra.max_parallelism);}cb&&i.remove(cb);}}function xa(){var bb,cb,db=false;for(var eb=0;eb<ia.length;eb++){var fb=ia[eb];if(!fb)continue;var gb=o.get(fb);if(gb&&(gb.canScrollLoad||gb.loaded)){if(!gb.loaded){h.removeClass(gb.node,'fbTimelineTimePeriodSuppressed');h.addClass(gb.node,'fbTimelineTimePeriodUnexpanded');}if(bb&&cb){ya(bb,cb);if(db)bb.deactivateScrollLoad();db=true;}bb=null;cb=null;continue;}else if(bb){cb=gb;gb.deactivateScrollLoad();}else{bb=gb;if(db)gb.activateScrollLoad();}h.removeClass(gb.node,'fbTimelineTimePeriodSuppressed');h.addClass(gb.node,'fbTimelineTimePeriodUnexpanded');}}function ya(bb,cb){h.removeClass(cb.node,'fbTimelineTimePeriodUnexpanded');h.addClass(cb.node,'fbTimelineTimePeriodSuppressed');var db=i.find(bb.node,'span.sectionLabel'),eb=i.find(cb.node,'span.sectionLabel');if(!eb.getAttribute('data-original-label'))eb.setAttribute('data-original-label',i.getText(eb));if(db.getAttribute('data-month')&&eb.getAttribute('data-month')&&db.getAttribute('data-year')==eb.getAttribute('data-year')){i.setContent(eb,ba._("Show {month1} - {month2} {year}",{month1:eb.getAttribute('data-month'),month2:db.getAttribute('data-month'),year:db.getAttribute('data-year')}));}else if(db.getAttribute('data-year')!==eb.getAttribute('data-year')){i.setContent(eb,ba._("Show {year1} - {year2}",{year1:eb.getAttribute('data-year'),year2:db.getAttribute('data-year')}));}else i.setContent(eb,ba._("Show {year}",{year:eb.getAttribute('data-year')}));}function za(bb){if(ea)for(var cb=0;cb<ia.length-1;cb++){var db=ia[cb];if(!db)continue;if(db!=bb){var eb=o.get(db);if(eb.loaded&&eb.canUnload)eb.unload();}}xa();}var ab={WAY_BACK:'way_back',RECENT:'recent',HEADER_SCROLL_CUTOFF:80,CURRENT_SECTION_OFFSET:150,FOOTER_HEIGHT:60,registerTimePeriod:function(bb,cb,db,eb,fb,gb,hb){ta();if(ja.contains(cb))return;var ib=new sa(bb,cb,db,eb,hb);if(!fb){ia[gb]=cb;ha[cb]=true;}else{ib.parentKey=fb;o.get(fb).subSections=o.get(fb).subSections||[];o.get(fb).subSections[gb]=ib;}o.set(cb,ib);ab.checkCurrentSectionChange();g.inform(m.SECTION_REGISTERED,{scrubberKey:cb});n.registerSectionKey(cb,gb);},reset:function(){for(var bb in la)la[bb].remove();for(var cb in ma)ma[cb]&&ma[cb].cancel();for(var db in na){na[db].unsubscribe();delete na[db];}fa&&fa.unsubscribe();fa=null;o.removeAll();ga=null;ha={};ia=[];ja=[];ka={};la={};ma={};oa=null;pa=null;qa=false;da=false;},checkCurrentSectionChange:function(){var bb=ab.getCurrentSection(),cb=ga&&ga.scrubberKey;if(bb&&bb.scrubberKey!==cb&&!bb.isPermalinkPeriod()){ga=bb;var db=bb.scrubberKey,eb=bb.parentKey;if(!eb){eb=db;db=null;}n.sectionHasChanged(eb,db);}},setTimeCutoff:function(bb){oa=bb;},getTimeCutoff:function(){return oa;},setParallelLoadConfig:function(bb){ra=bb;},getCurrentSection:function(){var bb={},cb=o.getAll();for(var db in cb){var eb=cb[db];if(!eb.loaded||ka[eb.scrubberKey])continue;var fb=t.getElementPosition(eb.node,'viewport').y;if(eb.scrubberKey=='recent')fb--;if(fb<ab.CURRENT_SECTION_OFFSET)bb[fb]=eb;}var gb=Math.max.apply(null,Object.keys(bb)),hb=gb==-Infinity;if(!hb){return bb[gb];}else if(ia[0])return o.get(ia[0]);return null;},capsuleForCurrentSection:function(){var bb=ab.getCurrentSection();return bb&&i.scry(bb.node,'ol.fbTimelineCapsule')[0];},enableScrollLoad:function(bb,cb,db,eb){bb=u(bb);var fb=i.scry(bb.parentNode,'ol.fbTimelineCapsule')[0];if(!fb)return;if(db===null){va(bb,cb,eb);}else n.runOnceWhenSectionFullyLoaded(va.curry(bb,cb,eb),cb,db);},enableScrollLoadOnClick:function(bb,cb,db){bb=u(bb);Event.listen(bb,'click',function(eb){eb.preventDefault();ab.enableScrollLoad(bb,cb,null,db);});},expandSectionOnClick:function(bb,cb){Event.listen(bb,'click',function(db){db.preventDefault();o.get(cb).expand();});},expandSubSectionsOnClick:function(bb,cb){Event.listen(bb,'click',function(db){db.preventDefault();o.get(cb).expandSubSections();});},getNextSectionKey:function(bb){for(var cb=0;cb<ia.length-1;cb++)if(ia[cb]==bb){while(cb<ia.length-1&&!ia[cb+1])cb++;return ia[cb+1];}var db=o.get(bb);if(!db||!db.parentKey)return;var eb=o.get(db.parentKey);if(!eb)return;for(var fb=0;fb<eb.subSections.length-1;fb++)if(eb.subSections[fb].scrubberKey==bb)return eb.subSections[fb+1].scrubberKey;},hideSection:function(bb){var cb=o.get(bb);cb&&h.hide(cb.node);var db=n.getCurrentScrubber();if(db){var eb=n.getCurrentScrubber().getNav(bb);eb&&h.hide(eb);}var fb=n.getCurrentStickyHeaderNav();fb&&fb.removeTimePeriod(bb);ka[bb]=true;},loadSectionOnClick:function(bb,cb){Event.listen(bb,'click',function(db){db.preventDefault();o.get(cb).load();});},removeSection:function(bb){for(var cb in ia)if(ia[cb]==bb){ia[cb]=null;break;}o.remove(bb);delete ha[bb];if(bb in la){la[bb].remove();delete la[bb];}var db=n.getCurrentStickyHeaderNav();db&&db.removeTimePeriod(bb);ja.push(bb);},removeSectionParent:function(bb){i.remove(u(bb).parentNode);},navigateToSection:function(bb,cb,db){pa.add_event("nav_"+bb);cb=!!cb;var eb=bb,fb=o.get(bb);if(!fb)return;if(!fb.loaded)p.enable();if(!ha[bb]){fb.node.style.minHeight=t.getViewportDimensions().y+'px';var gb=g.subscribe(m.SECTION_FULLY_LOADED,function(ob,pb){if(pb.scrubberKey===bb){fb.node.style.minHeight='';gb.unsubscribe();}});eb=fb.parentKey;var hb=o.get(eb).node;if(!h.hasClass(hb,'fbTimelineSectionExpanded')){j.scrollTo(hb,0);h.addClass(hb,'fbTimelineSectionExpanded');i.scry(hb,'ol.fbTimelineCapsule').forEach(i.remove);i.scry(hb,'div.fbTimelineSectionExpandPager').forEach(i.remove);i.scry(hb,'div.fbTimelineContentHeader').forEach(i.remove);i.scry(hb,"._5vf").forEach(function(ob){if(!ob.getAttribute('data-subsection'))i.remove(ob);});}var ib=ab.getNextSectionKey(eb);if(ib&&la[ib])la[ib].setBuffer(0);}for(var jb=0;jb<ia.length;jb++){var kb=ia[jb];if(!kb)continue;if(kb==eb)break;o.get(kb).deactivateScrollLoad();i.scry(u('timeline_tab_content'),'.fbTimelineSectionExpandPager').forEach(function(ob){var pb=l.getInstance(ob.id);pb&&pb.removeOnVisible();});}ab.adjustContentPadding();fb.load(db);xa();var lb=t.getScrollPosition().x,mb=t.getElementPosition(fb.node).y;if(!cb){var nb=ha[bb]?m.SCROLL_TO_OFFSET:m.SUBSECTION_SCROLL_TO_OFFSET;j.scrollTo(new t(lb,mb-nb,'document'),true,false,false,function(){var ob=t.getElementPosition(fb.node).y;j.scrollTo(new t(lb,ob-nb,'document'),false);var pb=i.scry(fb.node,'h3.uiHeaderTitle')[0];pb&&pb.focus();});}},adjustContentPadding:function(){var bb=z('timeline_tab_content');if(!bb)return;var cb=n.getCurrentKey()||q.TIMELINE_KEY;if(cb!==q.TIMELINE_KEY)return;var db=ia.length-1,eb=o.get(ia[db]);bb.style.paddingBottom=eb&&eb.loaded?null:t.getViewportDimensions().y-ab.CURRENT_SECTION_OFFSET-ab.HEADER_SCROLL_CUTOFF-ab.FOOTER_HEIGHT+'px';},adjustContentPaddingAfterLoad:function(bb,cb){n.runOnceWhenSectionFullyLoaded(ab.adjustContentPadding,bb,cb);},appendContentAfterLoad:function(bb,cb,db){n.runOnceWhenSectionFullyLoaded(i.appendContent.curry(u(bb),cb),db,'0');},markSectionAsLoaded:function(bb,cb,db){n.runOnceWhenSectionFullyLoaded(function(){z(bb)&&h.removeClass(u(bb).parentNode,'fbTimelineSectionLoading');},cb,db);},suppressSectionsAbove:function(bb){var cb,db;for(var eb=0;eb<ia.length;eb++){var fb=ia[eb];if(!fb)continue;cb=o.get(fb).node;db=null;if(w(bb.parentNode.children).indexOf(bb)<=w(cb.parentNode.children).indexOf(cb)){db=fb;break;}o.get(fb).deactivateScrollLoad();}if(db)ab.navigateToSection(db,true);},forceNoFriendActivity:function(){qa=true;},removeDupes:function(bb){var cb=z(bb);if(!cb)return;var db=i.scry(cb,'li.fbTimelineUnit'),eb={};for(var fb=0;fb<db.length;fb++){var gb=db[fb];if(gb.id&&aa(gb.id,'tl_unit_')){var hb=gb.id.substring(8,gb.id.length),ib=(gb.getAttribute('data-unit')=='ExperienceSummaryUnit'?gb.getAttribute('data-time'):1);if(eb.hasOwnProperty(hb)&&eb[hb]==ib){i.remove(gb);}else eb[hb]=ib;}}},removeLoadingState:function(bb){z(bb)&&h.removeClass(u(bb),'fbTimelineSectionLoading');},setExpandLoadDataForSection:function(bb,cb){var db=o.get(bb);db&&db.setExpandLoadData(cb);},updatePagerAfterLoad:function(bb,cb,db,eb){if(!l.getInstance(bb.firstChild.id))na[bb.firstChild.id]=g.subscribe(l.REGISTERED,function(fb,gb){na[bb.firstChild.id].unsubscribe();delete na[bb.firstChild.id];if(gb.id===bb.firstChild.id)ab.updatePagerAfterLoad(bb,cb,db,eb);});n.runOnceWhenSectionFullyLoaded(h.removeClass.curry(bb,'fbTimelineHiddenPager'),db,eb);n.runOnceWhenSectionFullyLoaded(n.adjustScrollingPagerBuffer.curry(bb.firstChild.id,cb),db,eb);}};e.exports=ab;});
__d("TimelineLogging",["TimelineController","reportData"],function(a,b,c,d,e,f){var g=b('TimelineController'),h=b('reportData'),i=false,j=0,k=null,l={init:function(m){if(i)return;j=m;g.register(g.LOGGING,this);},reset:function(){i=false;j=0;k=null;},log:function(m,n){n.profile_id=j;h(m,{gt:n});},logSectionChange:function(m,n){var o={timeline_section_change:1,key:m};if(k&&m==k){o.timeline_scrubber=1;k=null;}l.log('timeline',o);},logScrubberClick:function(m){k=m;}};e.exports=l;});
__d("TimelineStar",["event-extensions","Button","CSS","DOM","Parent","TimelineCapsule","Tooltip","URI","csx","cx"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Button'),h=b('CSS'),i=b('DOM'),j=b('Parent'),k=b('TimelineCapsule'),l=b('Tooltip'),m=b('URI'),n=b('csx'),o=b('cx');function p(r){return i.scry(r,"a._5m-")[0];}var q={STAR_CSS_ONLY:1,STAR_ASYNC_REQUIRED:2,ACTION_STAR:7,ACTION_UNSTAR:8,starUnitFromButton:function(r,s,t){var u=j.byClass(r,'timelineUnitContainer');q.starUnit(u,s,t);},starUnit:function(r,s,t){var u=p(r);if(u){h.addClass(u,"_5m_");return;}var v=r.parentNode;if(!t)i.setContent(v,s);h.removeClass(v,'fbTimelineTwoColumn');h.addClass(v,'fbTimelineOneColumn');v.removeAttribute('data-side');v.setAttribute('data-size','2');l.hide();k.balanceCapsule.curry(v.parentNode).defer();},unstarUnitFromButton:function(r,s,t){var u=j.byClass(r,'timelineUnitContainer');q.unstarUnit(u,s,t);},unstarUnit:function(r,s,t){var u=p(r);if(u){h.removeClass(u,"_5m_");return;}var v=r.parentNode;if(!t)i.setContent(v,s);h.removeClass(v,'fbTimelineOneColumn');h.addClass(v,'fbTimelineTwoColumn');v.setAttribute('data-side','l');v.setAttribute('data-size','1');l.hide();k.balanceCapsule.curry(v.parentNode).defer();},listenToButton:function(r,s){if(!r)return;switch(s){case q.STAR_CSS_ONLY:Event.listen(r,'click',function(event){if(h.hasClass(r,'async_saving')){event.preventDefault();return;}var u=h.hasClass(r,"_5m-"),v=j.byClass(r,'timelineUnitContainer'),w=new m(r.getAttribute('ajaxify')),x=w.getQueryData().customize_action,y=x==q.ACTION_STAR?q.starUnit:q.unstarUnit;if(u){h.toggleClass(r,"_5m_");}else{g.setEnabled.curry(r,false).defer();h.toggleClass(r,'fbTimelineStarButtonSelected');h.toggleClass(r,'selected');}y(v,null,true);var z=x==q.ACTION_STAR?q.ACTION_UNSTAR:q.ACTION_STAR;w.addQueryData({customize_action:z});r.setAttribute.bind(r,'ajaxify',w).defer();});var t=j.byClass(r,'stat_elem');t&&h.removeClass(t,'stat_elem');break;case q.STAR_ASYNC_REQUIRED:break;}}};e.exports=q;});
__d("legacy:TimelineCover",["TimelineCover"],function(a,b,c,d){a.TimelineCover=b('TimelineCover');},3);
__d("CountButtonCount",["ArbiterMixin","copyProperties","DOM"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('copyProperties'),i=b('DOM');function j(k,l,m){this._root=k;this._count=l;this._max=m;}h(j.prototype,g,{getCount:function(){return this._count;},setCount:function(k){this._count=k;var l=this.getDisplayedValue();i.setContent(this._root,l);this.inform('change',{value:this._count,max:this._max,display:l});return this;},addCount:function(k){this.setCount(this.getCount()+k);return this;},getDisplayedValue:function(k){var l=(this._count>this._max)?'+':'';return Math.max(0,Math.min(this._count,this._max))+l;}});e.exports=j;});
__d("CountButton",["copyProperties","CSS","cx"],function(a,b,c,d,e,f){var g=b('copyProperties'),h=b('CSS'),i=b('cx'),j={huge:"_4q9",large:"_9x",small:"_9w",hidden:"_9v"};function k(l,m){this._root=l;this._counter=m;this._initEvents();}g(k.prototype,{_initEvents:function(){this._counter.subscribe('change',this._counterChange.bind(this));},_counterChange:function(l,m){h.removeClass(this._root,j.huge);h.removeClass(this._root,j.large);h.removeClass(this._root,j.small);h.removeClass(this._root,j.hidden);var n=m.count>m.max;if(n&&m.max>9){h.addClass(this._root,j.huge);}else if(m.value>9||(n&&m.max>0)){h.addClass(this._root,j.large);}else if(m.value>0){h.addClass(this._root,j.small);}else h.addClass(this._root,j.hidden);},getCounter:function(){return this._counter;}});e.exports=k;});
__d("SubMenu",["event-extensions","Arbiter","copyProperties","CSS"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('copyProperties'),i=b('CSS');function j(){}h(j.prototype,{_subMenu:null,_mainMenu:null,_forward:null,_backward:null,init:function(k,l,m,n){this._subMenu=k;this._mainMenu=l;this._forward=m;this._backward=n;g.subscribe('SubMenu/Reset',this._goToMainMenu.bind(this));Event.listen(m,'click',this._goToSubMenu.bind(this));Event.listen(n,'click',this._goToMainMenu.bind(this));},initAsyncChildMenu:function(k){Event.listen(this._forward,'click',function(){this._goToSubMenu();k.load();}.bind(this));},_goToMainMenu:function(){i.hide(this._subMenu);i.show(this._mainMenu);},_goToSubMenu:function(){i.hide(this._mainMenu);i.show(this._subMenu);}});e.exports=j;});
__d("legacy:ui-submenu",["SubMenu"],function(a,b,c,d){a.SubMenu=b('SubMenu');},3);
__d("AsyncMenu",["AsyncRequest","copyProperties","emptyFunction"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('copyProperties'),i=b('emptyFunction');function j(k,l){this._uri=k;this._elem=l;}h(j.prototype,{_uri:null,_elem:null,load:function(){this.load=i;g.bootstrap(this._uri,this._elem);}});e.exports=j;});
__d("FileUploadTarget",["AsyncUploadRequest","DragDropFileUpload","DragDropTarget","copyProperties","emptyFunction"],function(a,b,c,d,e,f){var g=b('AsyncUploadRequest'),h=b('DragDropFileUpload'),i=b('DragDropTarget'),j=b('copyProperties'),k=b('emptyFunction');function l(m,n){var o=(function(p){var q=new g(n).setFiles({file:p}).setRelativeTo(m).setStatusElement(m);q.subscribe('complete',function(r,s){this.onCompleteCallback(s);}.bind(this));q.send();}).bind(this);this.dragDropTarget=new i(m).setOnFilesDropCallback(function(p){p.length&&this.asyncProcess(p,function(q){q.length&&o(q);});}.bind(this));this.asyncProcess=function(p,q){q(p);};this.preprocess=function(p){return p;};this.onCompleteCallback=k;}j(l.prototype,{setPreprocessor:function(m){this.preprocess=m;return this;},setAsyncProcessor:function(m){this.asyncProcess=m;return this;},onComplete:function(m){this.onCompleteCallback=m;return this;},activate:function(){if(!h.isSupported())return;this.dragDropTarget.setFileFilter(this.preprocess).enable();}});e.exports=l;});
__d("SinglePictureUploadTarget",["Bootloader","Dialog","ErrorDialog","FileUploadTarget","copyProperties","emptyFunction","htmlSpecialChars","tx"],function(a,b,c,d,e,f){var g=b('Bootloader'),h=b('Dialog'),i=b('ErrorDialog'),j=b('FileUploadTarget'),k=b('copyProperties'),l=b('emptyFunction'),m=b('htmlSpecialChars'),n=b('tx');function o(p,q){this.fileUploadTarget=new j(p,q);this.preprocessCallback=l;this.oncompleteCallback=l;this.afterSuccessCallback=l;this.maxWidth=null;this.maxHeight=null;}k(o.prototype,{setPreprocessCallback:function(p){this.preprocessCallback=p;return this;},setOncompleteCallback:function(p){this.oncompleteCallback=p;return this;},setAfterSuccessCallback:function(p){this.afterSuccessCallback=p;return this;},setMaximumDimensions:function(p,q){this.maxWidth=p;this.maxHeight=q;return this;},activate:function(){var p=function(t){return m(t.name);},q=(function(t){if(t.length>1){i.show("Upload Error",n._("You can only select {max-photos} photos to upload to this album.  Only the first {max-photos} photo you selected will be uploaded.",{'max-photos':1}));t=[t[0]];}var u=t[0];if(!u.type.match(/^image\//)){i.show("Upload Error",n._("We could not understand the contents of {filename}.  Make sure it is a jpg, gif, or png formatted image.",{filename:p(u)}));return [];}this.preprocessCallback(t);return t;}).bind(this),r=(function(t,u){var v=1024*1024*16,w=1024*1024*1,x=function(z){if(z.size>v){i.show("Upload Error",n._("{filename} is too large. Please resize your photo to under\n                     8000x8000 pixels and try again.",{filename:p(t[0])}));u([]);}else u([z]);},y=t[0];if((y.size<w)||(!this.maxWidth&&!this.maxHeight)){x(y);}else g.loadModules(['ImageExif','ImageResizer'],function(z,aa){if(!aa.isSupported()){x(y);return;}var ba=new aa(y,this.maxWidth,this.maxHeight);ba.subscribe('resized',function(ca,da){if(da.size>y.size){x(y);}else x(da);}.bind(this));ba.subscribe('error',function(){x(y);}.bind(this));z.readFromFile(y,function(ca){ca&&ba.setOrientation(ca.Orientation);ba.resize();});});}).bind(this),s=(function(t){var u=t[0];this.oncompleteCallback(u);var v=u.getResponse().getPayload();if(u.isSuccess()){this.afterSuccessCallback(v);}else if(v&&v.__dialog){var w=new h();w._setFromModel(v.__dialog);w.setButtons(h.OK).show();}else i.show(v.error.title,v.error.body);}).bind(this);return this.fileUploadTarget.onComplete(s).setPreprocessor(q).setAsyncProcessor(r).activate();}});e.exports=o;});
__d("ProfilePOPAlbumEducationDialog",["event-extensions","AsyncRequest"],function(a,b,c,d,e,f){b('event-extensions');var g=b('AsyncRequest'),h={listen:function(i,j){Event.listen(i,'click',function(){j.show();new g().setURI('/ajax/profile/picture/record_seen_nux/').send();});}};e.exports=h;});
__d("TimelineProfilePic",["Arbiter","CSS","Dialog","DOM","HTML","Run","$","ge","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('Dialog'),j=b('DOM'),k=b('HTML'),l=b('Run'),m=b('$'),n=b('ge'),o=b('copyProperties');function p(q,r,s,t){p.destroyInstance();p._instance=this;this.leavingMessage=r;this.elemID=s||'fbProfileCover';this.elemClass=t||'.profilePicThumb';this._arbiterTokens=[g.subscribe(q.LOADING,this.startLoading.bind(this)),g.subscribe(q.SUCCESS,this.onUploadSuccess.bind(this))];l.onBeforeUnload(this.onBeforeUnload.bind(this));l.onLeave(this.destroy.bind(this));}o(p,{_instance:null,destroyInstance:function(){this._instance&&this._instance.destroy();}});o(p.prototype,{_setLoadingIndicator:function(q){this._loading=q;h.conditionClass(j.find(m(this.elemID),this.elemClass),'profilePicLoading',q);},destroy:function(){this._arbiterTokens.forEach(function(q){q.unsubscribe();});this._arbiterTokens=[];p._instance=null;},startLoading:function(q,r){this._setLoadingIndicator(r.isLoading);if(n('fbProfilePicSelector'))h.removeClass(m('fbProfilePicSelector'),'fbTimelineNullProfilePicSelector');},onUploadSuccess:function(q,r){this._setLoadingIndicator(false);var s=i.getCurrent();if(s)s.hide();j.replace(j.find(m(this.elemID),this.elemClass),k(r.newPic));if(typeof(r.profileId)!==undefined&&typeof(r.headerPicURL)!==undefined){var t=n('profile_pic_header_'+r.profileId);if(t)t.src=r.headerPicURL;}},onBeforeUnload:function(){if(p._instance===this&&this._loading)return this.leavingMessage;}});e.exports=p;});
__d("timeline-cover-dragdrop-edit",["SinglePictureUploadTarget","TimelineCover"],function(a,b,c,d,e,f){var g=b('SinglePictureUploadTarget'),h=b('TimelineCover'),i=function(){var m=h.getInstance();m.hideLoadingIndicator();},j=function(m){var n=h.getInstance(),o=m.id,p=m.photo_html;n.updateCoverImage(o,p);},k=function(m){h.getInstance().showLoadingIndicator();},l=function(m,n,o,p){new g(m,n).setMaximumDimensions(o,p).setPreprocessCallback(k).setOncompleteCallback(i).setAfterSuccessCallback(j).activate();};f.initialize_timeline_cover_drop_target=l;});
__d("profile-pic-dragdrop-edit",["Arbiter","SinglePictureUploadTarget","TimelineProfilePic"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('SinglePictureUploadTarget'),i=b('TimelineProfilePic');f.initialize_profile_pic_drop_target=function(j,k,l,m){new i(l,m);new h(j,k).setPreprocessCallback(function(n){g.inform(l.LOADING,{isLoading:1},g.BEHAVIOR_STATE);}).setOncompleteCallback(function(){g.inform(l.LOADING,{isLoading:0},g.BEHAVIOR_STATE);}).setAfterSuccessCallback(function(n){g.inform(l.SUCCESS,{newPic:n.photo_html},g.BEHAVIOR_STATE);}).activate();};});
__d("ComposerXDatepickerIconReset",["CSS","cx"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('cx');function i(j){g.removeClass(j.element,"_t5");g.removeClass(j.element,"_4m");}e.exports=i;});
function TimelineCoverDisclaimer(a,b,c){if(TimelineCoverDisclaimer.displayed===undefined){TimelineCoverDisclaimer.displayed=true;}else return;new Dialog().setModal(true).setTitle(a).setBody(b).setButtonsMessage(c).setButtons(Dialog.OK).show();}
__d("MessageButton",["event-extensions","Chat","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Chat'),h=b('copyProperties');function i(){}h(i,{initChat:function(j,k,l){Event.listen(j,'click',function(){g.openTab(k,l,'friend');return false;});}});e.exports=i;});
__d("TimelineViewportTracking",["event-extensions","Class","DOM","ViewportTracking","$","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Class'),h=b('DOM'),i=b('ViewportTracking'),j=b('$'),k=b('copyProperties'),l=55;function m(){this.parent.construct(this);}g.extend(m,i);k(m.prototype,{getDataFromConfig:function(n){this.timeout=n.record_delay;},getTimeout:function(){return this.timeout;},getAllStories:function(){return h.scry(j('timeline_tab_content'),'.timelineUnitContainer');},getStoryID:function(n){var o=JSON.parse(n.getAttribute('data-gt'));return o&&o.contentid;},getDataToLog:function(n){var o={evt:l,timelineviewporttracking:true};return {gt:o};}});e.exports.init=function(n){(new m()).init(n);};});